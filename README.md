# PayTrack
## О проекте
Этот бэкэнд-сервер предоставляет API для работы с пользователями, администраторами и платежами. Он поддерживает следующие эндпоинты:

- **/users** - Для пользователей:
  - Авторизация по email
  - Регистрация
  - Получение данных (id, email, логин, полное имя)
  - Получение списка счетов (кошельков) и балансов
  - Получение списка платежей

- **/admins** - Для администраторов:
  - Авторизация по email
  - Получение данных о себе (id, email, логин, полное имя)
  - Создание/удаление/обновление пользователя или администратора
  - Получение списка пользователей и их счетов с балансами

- **/payments** - Для обработки платежей (пополнение баланса)


### Инструкция по общей подготовке к запуску бэкенд-сервера (обязательна):
  1.Клонируем репозиторий с сайта GitHub и заходим в директорию с проектом:
  ```
  git clone https://github.com/NoRIS95/PayTrack.git
  cd PayTrack

  ```
  2.Копируем шаблон .env .и вписываем необходимые данные:
  ```
  cp .env.template .env
  ```
  3.Вставляем необходимые данные в файл .env:
  ```
  POSTGRES_USER=<ваш postgres пользователь>
  POSTGRES_PASSWORD=<ваш postgres пароль>
  POSTGRES_DB=<название базы данных>
  POSTGRES_HOST=<localhost или db в зависимости от окружения>
  POSTGRES_PORT=<порт PostgreSQL>
  SECRET_KEY=<секретный ключ для хеширования>
  ```
  __Примечание__: SECRET_KEY — это секретный ключ, используемый для хеширования данных при обработке транзакций. Он должен быть уникальным и храниться в безопасности.

  ### Инструкция к запуску проекта без Docker Compose:
  1.Вставляем localhost в поле POSTGRES_HOST в файле .env:
  ```
  POSTGRES_HOST=localhost
  ```
  2.Устанавливаем Poetry, если он не установлен:
  ```
  curl -sSL https://install.python-poetry.org | python3 -
  ```
  3.Устанавливаем зависимости проекта через Poetry:
  ```
  poetry install
  ```
  4.Обновляем миграции базы данных:
  ```
  alembic upgrade head
  ```
  5.Запускаем сервер:
  ```
  poetry run uvicorn app.main:app --reload
  ```

  ### Инструкция к запуску проекта с Docker Compose:
  1.Вставляем db в поле POSTGRES_HOST в файле .env:
  ```
  POSTGRES_HOST=db
  ```
  2.Создаём контейнер в фоновом режиме
  ```
  sudo docker-compose up --build -d
  ```
  3.Создаём миграции в контейнере:
  ```
  sudo docker exec -it paytrack-app-1 python /app/migrates_for_docker.py
  ```

  ### Тестируемые данные для проверки пользователей:
  _Email администратора_: Petrov42@test.com
  _Email пользователя_: user1@test.com